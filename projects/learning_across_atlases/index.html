<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Learning brain phenotype relationship across atlases - Qinghao Liang</title>
  <meta name="description" content="Data heterogeneity, notably due to variations in brain atlases, poses a significant challenge in federated learning (FL) and meta-learning within neuroimaging, especially in functional MRI (fMRI) studies of neurological diseases. The diversity of brain atlases leads to inconsistencies in data representation, complicating the aggregation of insights across different datasets in a federated learning framework. This heterogeneity affects the collaborative training of models, as it introduces variability in data distributions and model architectures across institutions.">
  <meta name="author" content="Qinghao Liang"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Qinghao Liang",
    
    "url": "\/\/qinghaoliang.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "\/\/qinghaoliang.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "\/\/qinghaoliang.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "\/\/qinghaoliang.github.io\/projects\/learning_across_atlases\/",
          "name": "Learning brain phenotype relationship across atlases"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Qinghao Liang"
  },
  "headline": "Learning brain phenotype relationship across atlases",
  "description" : "Data heterogeneity, notably due to variations in brain atlases, poses a significant challenge in federated learning (FL) and meta-learning within neuroimaging, especially in functional MRI (fMRI) studies of neurological diseases. The diversity of brain atlases leads to inconsistencies in data representation, complicating the aggregation of insights across different datasets in a federated learning framework. This heterogeneity affects the collaborative training of models, as it introduces variability in data distributions and model architectures across institutions.",
  "inLanguage" : "en",
  "wordCount":  847 ,
  "datePublished" : "2024-02-10T22:10:16",
  "dateModified" : "2024-02-10T22:10:16",
  "image" : "\/\/qinghaoliang.github.io\/img\/profile.png",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "\/\/qinghaoliang.github.io\/projects\/learning_across_atlases\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "\/\/qinghaoliang.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "\/\/qinghaoliang.github.io\/img\/profile.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Learning brain phenotype relationship across atlases" />
<meta property="og:description" content="Data heterogeneity, notably due to variations in brain atlases, poses a significant challenge in federated learning (FL) and meta-learning within neuroimaging, especially in functional MRI (fMRI) studies of neurological diseases. The diversity of brain atlases leads to inconsistencies in data representation, complicating the aggregation of insights across different datasets in a federated learning framework. This heterogeneity affects the collaborative training of models, as it introduces variability in data distributions and model architectures across institutions.">
<meta property="og:image" content="//qinghaoliang.github.io/img/profile.png" />
<meta property="og:url" content="//qinghaoliang.github.io/projects/learning_across_atlases/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Qinghao Liang" />

  <meta name="twitter:title" content="Learning brain phenotype relationship across atlases" />
  <meta name="twitter:description" content="Data heterogeneity, notably due to variations in brain atlases, poses a significant challenge in federated learning (FL) and meta-learning within neuroimaging, especially in functional MRI (fMRI) â€¦">
  <meta name="twitter:image" content="//qinghaoliang.github.io/img/profile.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@liang_qinghao" />
  <meta name="twitter:creator" content="@liang_qinghao" />
  <link href='//qinghaoliang.github.io/img/brain.png' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.104.1" />
  <link rel="alternate" href="//qinghaoliang.github.io/index.xml" type="application/rss+xml" title="Qinghao Liang"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="//qinghaoliang.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="//qinghaoliang.github.io/css/highlight.min.css" /><link rel="stylesheet" href="//qinghaoliang.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">

  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="//qinghaoliang.github.io/">Qinghao Liang</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Resume" href="/resume/Qinghao_resume.pdf">Resume</a>
            </li>
          
        
          
            <li>
              <a title="Publications" href="https://scholar.google.com/citations?user=jwf6KUEAAAAJ&amp;hl=en">Publications</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Projects</a>
              <div class="navlinks-children">
                
                  <a href="/projects/connectome_transformation">Resolving Atlas Divergence in Connectomes</a>
                
                  <a href="/projects/missing_data">Rescuing missing data</a>
                
                  <a href="/projects/learning_across_atlases">Learning across atlases</a>
                
              </div>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Qinghao Liang" href="//qinghaoliang.github.io/">
            <img class="avatar-img" src="//qinghaoliang.github.io/img/profile.png" alt="Qinghao Liang" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="projects-heading">
              
                <h1>Learning brain phenotype relationship across atlases</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>Data heterogeneity, notably due to variations in brain atlases, poses a significant challenge in federated learning (FL) and meta-learning within neuroimaging, especially in functional MRI (fMRI) studies of neurological diseases. The diversity of brain atlases leads to inconsistencies in data representation, complicating the aggregation of insights across different datasets in a federated learning framework. This heterogeneity affects the collaborative training of models, as it introduces variability in data distributions and model architectures across institutions. Similarly, in meta-learning, the goal of quickly adapting models to new tasks is hindered by the disparate data spaces generated by the use of various atlases, requiring more sophisticated approaches to achieve effective generalization. Addressing the challenges posed by atlas heterogeneity is crucial for the successful application of FL and meta-learning in neuroimaging, aiming to enhance precision medicine and the accuracy of fMRI analysis.</p>
<h2 id="method">Method</h2>
<h3 id="overcoming-atlas-space-heterogeneity-in-federated-learning-for-multi-site-connectome-modeling">Overcoming atlas space heterogeneity in federated learning for multi-site connectome modeling</h3>
<p><img src="/img/Fed.png" alt="fed">
<strong>Figure 1. Federated learning framework for sites with connectomes from different atlases. Initially, connectomes are locally transformed into the target atlas using online mapping resources. The local models, trained on the transformed data, are subsequently aggregated on the server and distributed back to the local nodes for updates.</strong></p>
<h3 id="meta-learning-across-heterogeneous-atlases-space">Meta Learning across heterogeneous atlases space</h3>
<p><img src="/img/meta.png" alt="meta">
<strong>Figure 2. Meta learning framework for connectomes across atlases</strong></p>
<p>Meta-learning, fundamentally regarded as &ldquo;learning to learn,&rdquo; is an advanced concept in machine learning that centers around crafting a meta-algorithm, denoted as \(\mathcal{M}\), which enhances its learning efficiency by harnessing experience from a diversity of tasks. In the meta-training stage, \(\mathcal{M}\) is trained on a set \( \cal T_{train} \), with each task \(T_i \in \cal T_{train}\) having its dataset \(D_i\). This stage aims to optimize \(\mathcal{M}\) such that it acquires a generalized learning strategy, capable of rapid adaptation to new tasks. This involves a dual-layered learning process: a task-specific learning for each \(T_i\) , where a model \(f_{\theta_i}\) is learned using \(D_i\), and a meta-level learning where the parameters of \(\mathcal{M}\) are adjusted based on the performance across these varied tasks. The objective is to enable \(\mathcal{M}\) to provide effective initial settings or learning approaches for unfamiliar tasks.</p>
<p>Following this, the meta-testing phase evaluates \(\mathcal{M}\) using a different set of tasks, \(\cal T_{test}\), with each \(T_{new} \in \cal T_{test}\) presenting a novel dataset \(D_{new}\). The meta-algorithm is then adapted to each \(T_{new}\) using a small portion of \(D_{new}\), emphasizing rapid and efficient adaptation. The success of \(\mathcal{M}\) in meta-testing is gauged by its quick learning capability, minimal data requirement for adaptation, and high generalization performance on unseen data from \(D_{new}\).</p>
<p>In our setting, the data in the meta-train set and meta-test set is in different atlas space. We first transformed the data in the meta-train set to the target atlas. A Deep Neural Network (DNN) is built trained to for each task in the meta-train set. On the support set of meta-test set, we either choose the DNN that has the highest predictive accuracy on the new task (Basic meta-matching) or train a regression model using the prediction of the every DNN (Advanced Meta-matching (Stacking)). The models are then applied on the query set for validation.</p>
<h2 id="result">Result</h2>
<h3 id="federated-learning-with-connectomes-of-multiple-atlases-improved-predictive-performance">Federated learning with connectomes of multiple atlases improved predictive performance</h3>
<p><img src="/img/fed_result.png" alt="fed_result">
<strong>Figure 3. Predictive performance of the federated learning model (Fed_avg) and models trained independently on each site, with colors corresponding to the atlas used at the training site. The horizontal axis displays the atlas names associated with the testing sites. All the participants were split into 5 partitions (sites) for 100 times in the experiments. Stars above the boxplots of Fed_avg indicate a significantly higher prediction performance relative to all the other models (p &lt; 0.001).</strong></p>
<p>As depicted in Figure 3, federated learning models exhibited superior performance compared to models trained on individual sites, encompassing a range of target atlases. These single-site models typically did not achieve significant predictive results, showing the tendency to overfit seen in models trained on single sites. Additionally, Fed_avg showed increased robustness, in stark contrast to the notably higher variance of the second-best single-site models.</p>
<h3 id="meta-learning-on-large-scale-datasets-with-a-different-atlas-improves-predictive-performance">Meta-learning on large-scale datasets with a different atlas improves predictive performance</h3>
<p><img src="/img/meta_result.png" alt="meta_result">
<strong>Figure 4. Meta-matching outperforms predictions from classical machine learning methods across hetergenous domain. The left plot illustrates a scenario where the training meta-set included FCs derived from 21 independent components, while the testing set FCs were based on 55 components. Conversely, the right plot displays the reversed condition, with 55 components in the training set and 21 in the testing set.</strong></p>
<p>Our connectome transformation approach overcomes a limitation in the original meta-matching framework, which required connectomes in large-scale datasets to match the atlas of smaller studies. As shown in Figure 4, advanced meta-matching consistently surpasses classical methods in predictive performance across various machine learning algorithms, particularly when K is less than 50. For K greater than 50, meta-matching&rsquo;s effectiveness diminishes compared to classical methods when training meta-set connectomes are transformed from low to high resolution. Nevertheless, meta-matching maintains its superiority for larger K values when the transformation is from high to low resolution. The advanced meta-matching method demonstrates the greatest stability and accuracy in predictions.</p>


        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=%2f%2fqinghaoliang.github.io%2fprojects%2flearning_across_atlases%2f&amp;text=Learning%20brain%20phenotype%20relationship%20across%20atlases&amp;via=liang_qinghao" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
  
      
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=%2f%2fqinghaoliang.github.io%2fprojects%2flearning_across_atlases%2f&amp;title=Learning%20brain%20phenotype%20relationship%20across%20atlases" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      

      
    </ul>
  </div>
  

              </div>
            </section>
        

        
          

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="//qinghaoliang.github.io/projects/missing_data/" data-toggle="tooltip" data-placement="top" title="Rescuing missing data with imputation in connectome-based predictive modeling">&larr; Previous Post</a>
            </li>
          
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:qinghao.liang@yale.edu" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/qinghaoliang" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/liang_qinghao" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/qinghao" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Qinghao Liang
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2024
          

          
            &nbsp;&bull;&nbsp;
            <a href="//qinghaoliang.github.io/">Qinghao Liang</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//qinghaoliang.github.io/js/main.js"></script>
<script src="//qinghaoliang.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="//qinghaoliang.github.io/js/load-photoswipe.js"></script>









    
  </body>
</html>

