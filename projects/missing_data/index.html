<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Rescuing missing data with imputation in connectome-based predictive modeling - Qinghao (Leo) Liang</title>
  <meta name="description" content="Our manuscript is published at Imaging Neuroscience https://direct.mit.edu/imag/article/doi/10.1162/imag_a_00071/118937
Connectome-based Predictive modeling Figure 1. Flowchart of Connectome-based Predictive modeling in neuroimage analysis.
Connectome-based Predictive Modeling (CPM) is a technique in neuroscience that predicts individual behaviors, cognitive abilities, and disease states from brain connectivity patterns. The neuroimaging data is first preprocessing and parcelated using brain atlas. Connectome is then generated by the correlaiton of average functional Magnetic resonance imaging (fMRI) timeseries between nodes or tracking the white matter fibers in Diffusion Tensor Imaging (DTI).">
  <meta name="author" content="Qinghao Liang"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Qinghao (Leo) Liang",
    
    "url": "\/\/qinghaoliang.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "\/\/qinghaoliang.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "\/\/qinghaoliang.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "\/\/qinghaoliang.github.io\/projects\/missing_data\/",
          "name": "Rescuing missing data with imputation in connectome based predictive modeling"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Qinghao Liang"
  },
  "headline": "Rescuing missing data with imputation in connectome-based predictive modeling",
  "description" : "Our manuscript is published at Imaging Neuroscience https:\/\/direct.mit.edu\/imag\/article\/doi\/10.1162\/imag_a_00071\/118937\nConnectome-based Predictive modeling Figure 1. Flowchart of Connectome-based Predictive modeling in neuroimage analysis.\nConnectome-based Predictive Modeling (CPM) is a technique in neuroscience that predicts individual behaviors, cognitive abilities, and disease states from brain connectivity patterns. The neuroimaging data is first preprocessing and parcelated using brain atlas. Connectome is then generated by the correlaiton of average functional Magnetic resonance imaging (fMRI) timeseries between nodes or tracking the white matter fibers in Diffusion Tensor Imaging (DTI).",
  "inLanguage" : "en",
  "wordCount":  910 ,
  "datePublished" : "2024-02-05T16:10:19",
  "dateModified" : "2024-02-05T16:10:19",
  "image" : "\/\/qinghaoliang.github.io\/img\/profile.png",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "\/\/qinghaoliang.github.io\/projects\/missing_data\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "\/\/qinghaoliang.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "\/\/qinghaoliang.github.io\/img\/profile.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Rescuing missing data with imputation in connectome-based predictive modeling" />
<meta property="og:description" content="Our manuscript is published at Imaging Neuroscience https://direct.mit.edu/imag/article/doi/10.1162/imag_a_00071/118937
Connectome-based Predictive modeling Figure 1. Flowchart of Connectome-based Predictive modeling in neuroimage analysis.
Connectome-based Predictive Modeling (CPM) is a technique in neuroscience that predicts individual behaviors, cognitive abilities, and disease states from brain connectivity patterns. The neuroimaging data is first preprocessing and parcelated using brain atlas. Connectome is then generated by the correlaiton of average functional Magnetic resonance imaging (fMRI) timeseries between nodes or tracking the white matter fibers in Diffusion Tensor Imaging (DTI).">
<meta property="og:image" content="//qinghaoliang.github.io/img/profile.png" />
<meta property="og:url" content="//qinghaoliang.github.io/projects/missing_data/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Qinghao (Leo) Liang" />

  <meta name="twitter:title" content="Rescuing missing data with imputation in connectome-based predictive …" />
  <meta name="twitter:description" content="Our manuscript is published at Imaging Neuroscience https://direct.mit.edu/imag/article/doi/10.1162/imag_a_00071/118937
Connectome-based Predictive modeling Figure 1. Flowchart of Connectome-based …">
  <meta name="twitter:image" content="//qinghaoliang.github.io/img/profile.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@liang_qinghao" />
  <meta name="twitter:creator" content="@liang_qinghao" />
  <link href='//qinghaoliang.github.io/img/brain.png' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.104.1" />
  <link rel="alternate" href="//qinghaoliang.github.io/index.xml" type="application/rss+xml" title="Qinghao (Leo) Liang"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="//qinghaoliang.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="//qinghaoliang.github.io/css/highlight.min.css" /><link rel="stylesheet" href="//qinghaoliang.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">

  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="//qinghaoliang.github.io/">Qinghao (Leo) Liang</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Resume" href="/resume/Qinghao_resume.pdf">Resume</a>
            </li>
          
        
          
            <li>
              <a title="Publications" href="https://scholar.google.com/citations?user=jwf6KUEAAAAJ&amp;hl=en">Publications</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Projects</a>
              <div class="navlinks-children">
                
                  <a href="/projects/connectome_transformation">Resolving Atlas Divergence in Connectomes</a>
                
                  <a href="/projects/missing_data">Rescuing missing data</a>
                
                  <a href="/projects/learning_across_atlases">Learning across atlases</a>
                
              </div>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Qinghao (Leo) Liang" href="//qinghaoliang.github.io/">
            <img class="avatar-img" src="//qinghaoliang.github.io/img/profile.png" alt="Qinghao (Leo) Liang" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="projects-heading">
              
                <h1>Rescuing missing data with imputation in connectome-based predictive modeling</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>Our manuscript is published at Imaging Neuroscience <a href="https://direct.mit.edu/imag/article/doi/10.1162/imag_a_00071/118937">https://direct.mit.edu/imag/article/doi/10.1162/imag_a_00071/118937</a></p>
<h2 id="connectome-based-predictive-modeling">Connectome-based Predictive modeling</h2>
<p><img src="/img/CPM.png" alt="CPM">
<strong>Figure 1. Flowchart of Connectome-based Predictive modeling in neuroimage analysis.</strong></p>
<p>Connectome-based Predictive Modeling (CPM) is a technique in neuroscience that predicts individual behaviors, cognitive abilities, and disease states from brain connectivity patterns.
The neuroimaging data is first preprocessing and parcelated using brain atlas. Connectome is then generated by the correlaiton of average functional Magnetic resonance imaging (fMRI) timeseries between nodes or tracking the white matter fibers in Diffusion Tensor Imaging (DTI).
As a bridge between neuroscience and data science, CPM offers profound insights into the brain&rsquo;s role in behavior and disease, highlighting its potential for advancing personalized medicine and targeted treatments in neurological and psychiatric disorders.</p>
<h2 id="method">Method</h2>
<p><img src="/img/imp_flow.png" alt="workflow">
<strong>Figure 2. Predictive modeling framework for handling missing data. Missing connectomes are rescued using 1) Task average replacement, 2) Mean imputation, 3) Constant value imputation, 4) Robust Matrix Completion, or 5) Nearest Neighbors imputation. Missing phenotypic measures are imputed with auxiliary variables using 1) Predictive mean matching (PMM), 2) ImputePCA, 3) MissForest, or 4) Mean imputation. The phenotypic and connectivity data are then used in standardized predictive models such as ridge regression or support vector machine. The black squares represent missing data.</strong></p>
<h3 id="validation-methods">Validation methods</h3>
<p>Models were evaluated using 10-fold cross-validation. Complete-case analysis served as the baseline. Participants with missing data (\(X\) or \(y\)) were included only in the training set. The testing set consisted only of participants with complete data. Additionally, we assessed models on participants with missing X by randomly splitting all participants into training and testing sets.
Notably, missing data from the training and testing sets were imputed independently to prevent data leakage. A feature selection threshold of p &lt; 0.01 was used to select features in the training set. The ridge regression hyper-parameter was determined by grid searching using nested 5-fold cross-validation within the training set. For regression, the model performance was evaluated by the cross-validated \(R^2\), \(R^2_{CV}=1-\sum_{i=1}^n(y_i-\hat{y})^2/\sum_{i=1}^n(y_{i}-\bar{y})^2\). \(R^2_{CV}\) can be negative, which suggests the predictive model performs worse than simply guessing the mean of the phenotypic measure. In this case, we set it to 0. For classification, the model performance was evaluated by each fold&rsquo;s average Area Under the Receiver Operating Characteristic Curve (ROC AUC).</p>
<h2 id="datasets">Datasets</h2>
<p>Four datasets were used in our study: the Human Connectome Project (HCP) 900 Subject Release, the UCLA Consortium for Neuropsychiatric Phenomics (CNP), the Philadelphia Neurodevelopmental Cohort (PNC) and the Healthy Brain Network (HBN).</p>
<h2 id="results">Results</h2>
<h3 id="imputing-missing-connectomes-improves-prediction-performance">Imputing missing connectomes improves prediction performance</h3>
<p><img src="/img/imp_com.png" alt="com">
<strong>Figure 3. Prediction performance of models built on datasets with missing connectome data. The testing set only includes participants with complete data. Prediction performance of sex, age and fluid intelligence based on data imputed using multiple imputation strategies in three datasets, including CNP, PNC and HCP. Stars above the boxplots indicate a significantly higher prediction performance relative to complete-case analysis (p &lt; 0.001).</strong></p>
<p>Using real missing data, we investigated if imputing missing connectomes improves prediction performance. Fig. 2 presents the prediction performance of phenotypic measures (sex, age, IQ) based on complete-case data and data imputed using multiple methods. Our results demonstrate that imputing missing data can significantly improve prediction accuracy compared to models built on complete data, in most cases. For sex classification, all models achieved high accuracy (&gt;0.9) across all three datasets.</p>
<h3 id="imputing-missing-phenotypic-data-improves-prediction-performance">Imputing missing phenotypic data improves prediction performance</h3>
<p><img src="/img/imp_phe.png" alt="phe">
<strong>Figure 4. Prediction performance of models built with HBN participants with missing phenotypic measures. a) Performance of predicting a single cognitive measure. b) Performance of predicting the first principal component of ten cognitive measures.</strong></p>
<p>In the HBN dataset, a substantial number of participants have missing connectomes and cognitive measures. Through imputation, we were able to rescue several participants: 33 for CardSort, 34 for Flanker, 42 for ProcSpeed, and 54 for Working Memory. For predicting the first principal component of ten cognitive measures, 195 participants were rescued by imputing the missing cognitive measures. Only participants with missing data were included in the training set, and the prediction performance was evaluated on the same testing set used for complete-case analysis. As depicted in Figure 4 a and b, imputing missing cognitive measures significantly improved the prediction performance compared to complete-case analysis. Among the four imputation methods used, mean imputation yielded the lowest prediction performance.</p>
<h3 id="imputing-missing-connectomes-and-missing-phenotypic-data-to-rescue-the-maximum-amount-of-data">Imputing missing connectomes and missing phenotypic data to rescue the maximum amount of data</h3>
<p><img src="/img/imp_real.png" alt="real">
<strong>Figure 5. Prediction performance of models built with HBN participants with both missing connectomes and missing phenotypic measures. Missing connectomes were imputed using mean imputation and task average imputation. Missing cognitive measures were imputed using MissForest, ImputePCA, and PMM. In this example, we predicted the first principal component of ten cognitive measures from the HBN dataset.</strong></p>
<p>Finally, we present a real-world example of the benefits of data imputation in predicting cognition in the HBN dataset. In this example, we predicted the first principal component of ten cognitive measures. The prediction performance in the complete case was 0.295±0.024. 628 participants were rescued by imputing both the missing cognitive measures and connectomes. For imputing missing connectome data, we employed two simple methods: mean imputation and task average imputation. However, due to its inferior performance, meaning imputation was not used for imputing missing cognitive measures. The prediction performance was significantly greater when including the imputed data in the training set (Figure. 5). The combination of task average imputation and MissForest achieved the highest prediction performance (0.347±0.018). Overall, correlation between observed and predicted was ~20% greater and explained variance was ~45% greater after including imputed data in the training set.</p>


        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=%2f%2fqinghaoliang.github.io%2fprojects%2fmissing_data%2f&amp;text=Rescuing%20missing%20data%20with%20imputation%20in%20connectome-based%20predictive%20modeling&amp;via=liang_qinghao" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
  
      
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=%2f%2fqinghaoliang.github.io%2fprojects%2fmissing_data%2f&amp;title=Rescuing%20missing%20data%20with%20imputation%20in%20connectome-based%20predictive%20modeling" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      

      
    </ul>
  </div>
  

              </div>
            </section>
        

        
          

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="//qinghaoliang.github.io/projects/connectome_transformation/" data-toggle="tooltip" data-placement="top" title="Resolving Atlas Divergence in Connectomes: A Lightweight Domain Adaptation Approach Using Optimal Transport">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="//qinghaoliang.github.io/projects/learning_across_atlases/" data-toggle="tooltip" data-placement="top" title="Learning brain phenotype relationship across atlases">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:qinghao.liang@yale.edu" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/qinghaoliang" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/liang_qinghao" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/qinghao" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Qinghao Liang
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2024
          

          
            &nbsp;&bull;&nbsp;
            <a href="//qinghaoliang.github.io/">Qinghao (Leo) Liang</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//qinghaoliang.github.io/js/main.js"></script>
<script src="//qinghaoliang.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="//qinghaoliang.github.io/js/load-photoswipe.js"></script>









    
  </body>
</html>

